buildscript {
    repositories {
        maven {
            url 'https://github.com/steffenschaefer/gwt-gradle-plugin/raw/maven-repo/'
        }
        
        mavenCentral()
    }
    dependencies {
        classpath 'de.richsource.gradle.plugins:gwt-gradle-plugin:+'
    }
}

apply plugin: 'gwt'

configurations {
	gwt
	gwtTest
}

dependencies {
	compile project(path: ':mango-demo-server')
	compile project(path: ':mango-demo-model', configuration: 'generatedVOs')
	compile project(path: ':mango-client-web-test')
	compile project(path: ':mango-client-gwt')

	gwtTest group: 'com.google.gwt', name: 'gwt-dev', version: versions.gwt
	
}

gwt {
    gwtVersion = versions.gwt
    modules 'io.pelle.mango.demo.DemoClient'
    
	src += files(project(':mango-client-base').sourceSets.main.allJava.srcDirs) + 
			files(project(':mango-client-core').sourceSets.main.allJava.srcDirs) + 
			files(project(':mango-client-web').sourceSets.main.allJava.srcDirs) +
			files(project(':mango-client-gwt').sourceSets.main.allJava.srcDirs)
}

ext.gwtTestLibDir = new File('lib-gwt-test')

task copyGwtTestLibs(type: Copy) {
	gwtTestLibDir.mkdirs()
	into gwtTestLibDir
	from configurations.gwtTest
}

test.dependsOn(copyGwtTestLibs)
test.dependsOn(project(':mango-demo-server').tasks.test)

//superDevTask.dependsOn(JavaPlugin.COMPILE_JAVA_TASK_NAME, JavaPlugin.PROCESS_RESOURCES_TASK_NAME);
